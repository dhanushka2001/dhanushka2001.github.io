<!DOCTYPE html><html lang="en"> <head><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Scrapping the steam top sellers with dart - Dhanushka&#39;s Blog</title><meta name="description" content="Adding an endpoint on a dart backend to get the top sellers from steam"><meta name="author" content="Dhanushka Jayagoda"><link rel="alternate" type="application/rss+xml" href="/rss.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2479144310234386" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119155027-6"></script><script type="text/javascript">
      let slideIndex = 1;
      showSlides(slideIndex);

      function plusSlides(n) {
        showSlides((slideIndex += n));
      }

      function currentSlide(n) {
        showSlides((slideIndex = n));
      }

      function showSlides(n) {
        try {
          let i;
          let slides = document.getElementsByClassName('mySlides');
          let dots = document.getElementsByClassName('demo');
          let captionText = document.getElementById('caption');
          if (n > slides.length) {
            slideIndex = 1;
          }
          if (n < 1) {
            slideIndex = slides.length;
          }
          for (i = 0; i < slides.length; i++) {
            slides[i].style.display = 'none';
          }
          for (i = 0; i < dots.length; i++) {
            dots[i].className = dots[i].className.replace(' active', '');
          }
          slides[slideIndex - 1].style.display = 'block';
          dots[slideIndex - 1].className += ' active';
          captionText.innerHTML = dots[slideIndex - 1].alt;
        } catch (err) {
          // do nothing here
        }
      }
    </script><!-- Google Tag Manager --><!-- End Google Tag Manager --><link rel="stylesheet" href="/_astro/index.B_2FsOPP.css" />
<style>.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}@media print{.no-print,.no-print *{display:none!important}}
</style><script type="module" src="/_astro/hoisted.UksxmqGZ.js"></script></head> <body class="bg-slate-900 text-gray-100"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K8P5P8FQ" height="0" width="0" style="display:none;visibility:hidden"></iframe> </noscript> <!-- End Google Tag Manager (noscript) --> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="flex flex-col gap-y-3 sm:flex-row sm:items-center sm:justify-between"><a href="/"><div class="flex items-center bg-gradient-to-br from-sky-500 to-cyan-400 bg-clip-text text-xl font-bold text-transparent"><svg class="mr-1 h-10 w-10 stroke-cyan-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M0 0h24v24H0z" stroke="none"></path><rect x="3" y="12" width="6" height="8" rx="1"></rect><rect x="9" y="8" width="6" height="12" rx="1"></rect><rect x="15" y="4" width="6" height="16" rx="1"></rect><path d="M4 20h14"></path></svg>Dhanushka&#x27;s Blog</div></a><nav><ul class="flex gap-x-3 font-medium text-gray-200"><li class="hover:text-white"><a href="/posts">Blogs</a></li><li class="hover:text-white"><a href="https://github.com/dhanushka2001/blog-astro">GitHub</a></li><li class="hover:text-white"><a href="/photos">Photos</a></li></ul></nav></div></div> <div data-pagefind-body>  <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var v=Object.defineProperty;var A=(c,s,a)=>s in c?v(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a;var d=(c,s,a)=>(A(c,typeof s!="symbol"?s+"":s,a),a);var u;{let c={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},s=t=>{let[e,n]=t;return e in c?c[e](n):void 0},a=t=>t.map(s),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,s(n)]));customElements.get("astro-island")||customElements.define("astro-island",(u=class extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var f;if(!this.hydrator||!this.isConnected)return;let e=(f=this.parentElement)==null?void 0:f.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),r={},l=this.querySelectorAll("template[data-astro-template]");for(let o of l){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("data-astro-template")||"default"]=o.innerHTML,o.remove())}for(let o of n){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("name")||"default"]=o.innerHTML)}let h;try{h=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(o){let i=this.getAttribute("component-url")||"<unknown>",b=this.getAttribute("component-export");throw b&&(i+=` (export ${b})`),console.error(`[hydrate] Error parsing props for component ${i}`,this.getAttribute("props"),o),o}let p;await this.hydrator(this)(this.Component,h,r,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),n.disconnect(),this.childrenConnectedCallback()},n=new MutationObserver(()=>{var r;((r=this.lastChild)==null?void 0:r.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});n.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}try{await Astro[n](async()=>{let r=this.getAttribute("renderer-url"),[l,{default:h}]=await Promise.all([import(this.getAttribute("component-url")),r?import(r):()=>()=>{}]),p=this.getAttribute("component-export")||"default";if(!p.includes("."))this.Component=l[p];else{this.Component=l;for(let y of p.split("."))this.Component=this.Component[y]}return this.hydrator=h,this.hydrate},e,this)}catch(r){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,r)}}attributeChangedCallback(){this.hydrate()}},d(u,"observedAttributes",["props"]),u))}})();</script><astro-island uid="Z1NR8sR" prefix="r3" component-url="/_astro/BlogPost._FxswCuE.js" component-export="default" renderer-url="/_astro/client.D9Vng9vH.js" props="{&quot;frontmatter&quot;:[0,{&quot;tags&quot;:[1,[[0,&quot;bs4&quot;],[0,&quot;dart&quot;],[0,&quot;alfred&quot;]]],&quot;title&quot;:[0,&quot;Scrapping the steam top sellers with dart&quot;],&quot;description&quot;:[0,&quot;Adding an endpoint on a dart backend to get the top sellers from steam&quot;],&quot;pubDate&quot;:[0,&quot;Fri, 28 Feburary 2024&quot;],&quot;imgSrc&quot;:[0,&quot;/imgs/2023/986397498.png&quot;],&quot;authors&quot;:[1,[[0,&quot;David Li&quot;]]],&quot;file&quot;:[0,&quot;/home/runner/work/blog-astro/blog-astro/src/pages/posts/tech/flutter/steam_top_sellers_in_dart.md&quot;],&quot;url&quot;:[0,&quot;/posts/tech/flutter/steam_top_sellers_in_dart&quot;]}]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;BlogPost&quot;,&quot;value&quot;:true}" await-children=""><div class="mx-auto max-w-screen-lg px-3 py-6"><div><h1 class="text-center text-3xl font-bold">Scrapping the steam top sellers with dart</h1><div class="text-center text-sm text-gray-400"><div class="mt-1">Published:<!-- --> <!-- -->Feb 28, 2024</div><div class="mt-2 flex flex-wrap items-center justify-center gap-4"><div class="flex items-center space-x-2"><img src="/assets/images/avatars/david.png" alt="David Li" class="h-6 w-6 rounded-full object-cover" loading="lazy"/><a href="https://github.com/FriendlyUser" target="_blank" rel="noopener noreferrer" class="hover:underline">David Li</a></div></div></div><div class="flex place-content-center pt-2"><div class="rounded-md px-2 py-1 text-xs font-semibold bg-cyan-400 text-cyan-900"> <a href="/tags/bs4" style="padding-right:3px"> <category>bs4<!-- --> </category></a></div> <div class="rounded-md px-2 py-1 text-xs font-semibold bg-sky-400 text-sky-900"> <a href="/tags/dart" style="padding-right:3px"> <category>dart<!-- --> </category></a></div> <div class="rounded-md px-2 py-1 text-xs font-semibold bg-red-400 text-red-900"> <a href="/tags/alfred" style="padding-right:3px"> <category>alfred<!-- --> </category></a></div> </div><div class="mx-auto mt-5 max-w-prose"><div class="aspect-h-2 aspect-w-3"><img class="h-full w-full rounded-lg object-cover object-center" src="/imgs/2023/986397498.png" loading="lazy"/></div><div class="prose prose-invert mt-6 prose-img:rounded-lg"><content><astro-slot> <p>Web scraping is a technique used to extract data from websites, with the help of a software program. This process involves sending HTTP requests to the URL of a website and then parsing the HTML response to extract data from it. The data that can be scraped from websites includes text, images, videos, and links to other pages. The extracted data can be saved to a local file or a database, or it can be used to perform further analysis and processing.</p>
<p>Web scraping is commonly used for a variety of purposes, including data mining, data analysis, price comparison, sentiment analysis, and much more. It’s an efficient and automated way to collect information from websites, and it can save a significant amount of time compared to manual data collection.</p>
<p>However, it’s important to note that web scraping can be unethical if it is performed without the consent of the website owner or if it violates the website’s terms of service. Additionally, some websites may have protections in place to prevent web scraping, such as CAPTCHAs or rate limiting, so it’s important to respect the rules of the websites you scrape.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">Future</span><span style="color:#F8F8F2">&#x3C;</span><span style="color:#66D9EF;font-style:italic">List</span><span style="color:#F8F8F2">&#x3C;</span><span style="color:#66D9EF;font-style:italic">SteamTopSeller</span><span style="color:#F8F8F2">>> </span><span style="color:#A6E22E">findTopSteamSellers</span><span style="color:#F8F8F2">() </span><span style="color:#F92672">async</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  var</span><span style="color:#F8F8F2"> url </span><span style="color:#F92672">=</span><span style="color:#66D9EF;font-style:italic"> Uri</span><span style="color:#F8F8F2">.</span><span style="color:#A6E22E">https</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'store.steampowered.com'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'search/?filter=topsellers'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  var</span><span style="color:#F8F8F2"> html </span><span style="color:#F92672">=</span><span style="color:#F92672"> await</span><span style="color:#F8F8F2"> http.</span><span style="color:#A6E22E">get</span><span style="color:#F8F8F2">(url);</span></span>
<span class="line"><span style="color:#F92672">  return</span><span style="color:#A6E22E"> parseSteamTopSellers</span><span style="color:#F8F8F2">(html.body);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">List</span><span style="color:#F8F8F2">&#x3C;</span><span style="color:#66D9EF;font-style:italic">SteamTopSeller</span><span style="color:#F8F8F2">> </span><span style="color:#A6E22E">parseSteamTopSellers</span><span style="color:#F8F8F2">(</span><span style="color:#66D9EF;font-style:italic">String</span><span style="color:#F8F8F2"> rawHTML ) {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  BeautifulSoup</span><span style="color:#F8F8F2">  soup </span><span style="color:#F92672">=</span><span style="color:#66D9EF;font-style:italic"> BeautifulSoup</span><span style="color:#F8F8F2">(rawHTML);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  var</span><span style="color:#F8F8F2"> searchResultsDiv </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> soup.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'div'</span><span style="color:#F8F8F2">, attrs</span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> {</span><span style="color:#E6DB74">'id'</span><span style="color:#F92672">:</span><span style="color:#E6DB74"> 'search_resultsRows'</span><span style="color:#F8F8F2">});</span></span>
<span class="line"><span style="color:#F92672">  if</span><span style="color:#F8F8F2"> (searchResultsDiv </span><span style="color:#F92672">==</span><span style="color:#AE81FF"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F92672"> &#x3C;</span><span style="color:#66D9EF;font-style:italic">SteamTopSeller</span><span style="color:#F92672">></span><span style="color:#F8F8F2">[];</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  var</span><span style="color:#F8F8F2"> topSellers </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> searchResultsDiv.</span><span style="color:#A6E22E">findAll</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'a'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">  if</span><span style="color:#F8F8F2"> (topSellers.isEmpty) {</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F92672"> &#x3C;</span><span style="color:#66D9EF;font-style:italic">SteamTopSeller</span><span style="color:#F92672">></span><span style="color:#F8F8F2">[];</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  var</span><span style="color:#F8F8F2"> topSellersList </span><span style="color:#F92672">=</span><span style="color:#F92672"> &#x3C;</span><span style="color:#66D9EF;font-style:italic">SteamTopSeller</span><span style="color:#F92672">></span><span style="color:#F8F8F2">[];</span></span>
<span class="line"><span style="color:#F92672">  for</span><span style="color:#F8F8F2"> (</span><span style="color:#66D9EF;font-style:italic">var</span><span style="color:#F8F8F2"> topSeller </span><span style="color:#F92672">in</span><span style="color:#F8F8F2"> topSellers) {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    var</span><span style="color:#F8F8F2"> imageDiv </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> topSeller.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'img'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    String</span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> imageSrc </span><span style="color:#F92672">=</span><span style="color:#E6DB74"> ''</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> (imageDiv </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">      imageSrc </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> imageDiv.attributes[</span><span style="color:#E6DB74">'src'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    var</span><span style="color:#F8F8F2"> title </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> topSeller.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'span'</span><span style="color:#F8F8F2">, attrs</span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> {</span><span style="color:#E6DB74">'class'</span><span style="color:#F92672">:</span><span style="color:#E6DB74"> 'title'</span><span style="color:#F8F8F2">})</span><span style="color:#F92672">?</span><span style="color:#F8F8F2">.text;</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    var</span><span style="color:#F8F8F2"> publishDate </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> topSeller.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'div'</span><span style="color:#F8F8F2">, attrs</span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> {</span><span style="color:#E6DB74">'class'</span><span style="color:#F92672">:</span><span style="color:#E6DB74"> 'col search_released responsive_secondrow'</span><span style="color:#F8F8F2">})</span><span style="color:#F92672">?</span><span style="color:#F8F8F2">.text;</span></span>
<span class="line"><span style="color:#88846F">    // var publishDate = topSeller.find('div', attrs: {'class': 'tab_item_top_tags'}).text;</span></span>
<span class="line"><span style="color:#88846F">    // get data-price-final</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    var</span><span style="color:#F8F8F2"> price </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> topSeller.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'div'</span><span style="color:#F8F8F2">, attrs</span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> {</span><span style="color:#E6DB74">'class'</span><span style="color:#F92672">:</span><span style="color:#E6DB74"> 'search_price_discount_combined'</span><span style="color:#F8F8F2">})</span><span style="color:#F92672">?</span><span style="color:#F8F8F2">.attributes[</span><span style="color:#E6DB74">'data-price-final'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    var</span><span style="color:#F8F8F2"> discountDiv </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> topSeller.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'div'</span><span style="color:#F8F8F2">, attrs</span><span style="color:#F92672">:</span><span style="color:#F8F8F2"> {</span><span style="color:#E6DB74">'class'</span><span style="color:#F92672">:</span><span style="color:#E6DB74"> 'search_discount'</span><span style="color:#F8F8F2">});</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    String</span><span style="color:#F8F8F2"> discount </span><span style="color:#F92672">=</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> (discountDiv </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      var</span><span style="color:#F8F8F2"> discountSpan </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> discountDiv.</span><span style="color:#A6E22E">find</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">"span"</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F92672">      if</span><span style="color:#F8F8F2"> (discountSpan </span><span style="color:#F92672">!=</span><span style="color:#AE81FF"> null</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">        discount </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> discountSpan.text;</span></span>
<span class="line"><span style="color:#F8F8F2">      }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">    topSellersList.</span><span style="color:#A6E22E">add</span><span style="color:#F8F8F2">(</span><span style="color:#66D9EF;font-style:italic">SteamTopSeller</span><span style="color:#F8F8F2">(imageSrc, title, price, publishDate, discount));</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">  return</span><span style="color:#F8F8F2"> topSellersList; </span></span></code></pre>
<p>This code is a function in Dart that performs web scraping. It uses the <code>http</code> library to make a GET request to the Steam store’s top sellers page and retrieve its HTML content. Then it uses the <code>BeautifulSoup</code> library to parse the HTML and extract information about the top-selling games on Steam.</p>
<p>The <code>parseSteamTopSellers</code> function takes the raw HTML as a string as an argument, and uses the <code>BeautifulSoup</code> library to create a soup object. It then searches the HTML for the <code>div</code> element with an <code>id</code> of <code>search_resultsRows</code>, which contains the information about the top-selling games. If this <code>div</code> element is not found, the function returns an empty list.</p>
<p>Next, the code finds all the <code>a</code> elements within the <code>div</code> element, which correspond to individual games. For each game, the code extracts information such as the image source, title, publication date, price, and discount. It creates a <code>SteamTopSeller</code> object with this information and adds it to a list. Finally, the function returns this list of <code>SteamTopSeller</code> objects.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F92672"> class</span><span style="color:#66D9EF;font-style:italic"> SteamTopSeller</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  String</span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> imageSrc;</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  String</span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> title;</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  String</span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> price;</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  String</span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> publishDate;</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  String</span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> discount;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  SteamTopSeller</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.imageSrc, </span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.title, </span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.price, </span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.publishDate, </span><span style="color:#FD971F">this</span><span style="color:#F8F8F2">.discount);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E">  fromJson</span><span style="color:#F8F8F2">(</span><span style="color:#66D9EF;font-style:italic">Map</span><span style="color:#F8F8F2">&#x3C;</span><span style="color:#66D9EF;font-style:italic">String</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">dynamic</span><span style="color:#F8F8F2">> json) {</span></span>
<span class="line"><span style="color:#FD971F">    this</span><span style="color:#F8F8F2">.imageSrc </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> json[</span><span style="color:#E6DB74">'imageSrc'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#FD971F">    this</span><span style="color:#F8F8F2">.title </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> json[</span><span style="color:#E6DB74">'title'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#FD971F">    this</span><span style="color:#F8F8F2">.price </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> json[</span><span style="color:#E6DB74">'price'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#FD971F">    this</span><span style="color:#F8F8F2">.publishDate </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> json[</span><span style="color:#E6DB74">'publishDate'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#FD971F">    this</span><span style="color:#F8F8F2">.discount </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> json[</span><span style="color:#E6DB74">'discount'</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  Map</span><span style="color:#F8F8F2">&#x3C;</span><span style="color:#66D9EF;font-style:italic">String</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF;font-style:italic">dynamic</span><span style="color:#F8F8F2">> </span><span style="color:#A6E22E">toJson</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#E6DB74">      'imageSrc'</span><span style="color:#F92672">:</span><span style="color:#FD971F"> this</span><span style="color:#F8F8F2">.imageSrc,</span></span>
<span class="line"><span style="color:#E6DB74">      'title'</span><span style="color:#F92672">:</span><span style="color:#FD971F"> this</span><span style="color:#F8F8F2">.title,</span></span>
<span class="line"><span style="color:#E6DB74">      'price'</span><span style="color:#F92672">:</span><span style="color:#FD971F"> this</span><span style="color:#F8F8F2">.price,</span></span>
<span class="line"><span style="color:#E6DB74">      'publishDate'</span><span style="color:#F92672">:</span><span style="color:#FD971F"> this</span><span style="color:#F8F8F2">.publishDate,</span></span>
<span class="line"><span style="color:#E6DB74">      'discount'</span><span style="color:#F92672">:</span><span style="color:#FD971F"> this</span><span style="color:#F8F8F2">.discount,</span></span>
<span class="line"><span style="color:#F8F8F2">    };</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span></code></pre>
<p>This is a class definition for the <code>SteamTopSeller</code> object in Dart. It contains fields for the image source, title, price, publication date, and discount of a top-selling game on the Steam store.</p>
<p>The class has a constructor that takes these fields as arguments and sets them to the instance’s fields. It also has a <code>fromJson</code> method that creates a <code>SteamTopSeller</code> object from a JSON map and a <code>toJson</code> method that returns a JSON map representation of the object. These methods can be used for serializing and deserializing the <code>SteamTopSeller</code> object to and from JSON data, respectively.</p>
<p>For alfred classes, we require a <code>fromJson</code> and <code>toJson</code> method to be defined. This is because the <code>alfred</code> library uses the method  serialize and deserialize objects to and from JSON data. The <code>alfred</code> package requires that a <code>fromJson</code> and <code>toJson</code> method be defined for each class that needs to be serialized and deserialized.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#88846F"> // load sample.html and run findTopSteamSellers, expect list of top steam sellers</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#E6DB74"> 'dart:io'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#E6DB74"> 'package:test/test.dart'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#E6DB74"> "package:dart_off_server/core.dart"</span><span style="color:#F92672"> as</span><span style="color:#F8F8F2"> core;</span></span>
<span class="line"><span style="color:#F92672">import</span><span style="color:#E6DB74"> "package:path/path.dart"</span><span style="color:#F92672"> as</span><span style="color:#F8F8F2"> p;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">void</span><span style="color:#A6E22E"> main</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#A6E22E">  test</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'calculate'</span><span style="color:#F8F8F2">, () {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      var</span><span style="color:#F8F8F2"> rawHTMLPath </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> p.</span><span style="color:#A6E22E">join</span><span style="color:#F8F8F2">(p.current, </span><span style="color:#E6DB74">'test'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'sample.html'</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#88846F">      // load rawHTML from rawHTMLPath</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      File</span><span style="color:#F8F8F2"> file </span><span style="color:#F92672">=</span><span style="color:#66D9EF;font-style:italic"> File</span><span style="color:#F8F8F2">(rawHTMLPath);</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      var</span><span style="color:#F8F8F2"> rawHTML </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> file.</span><span style="color:#A6E22E">readAsStringSync</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      var</span><span style="color:#F8F8F2"> steamSellers </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> core.</span><span style="color:#A6E22E">parseSteamTopSellers</span><span style="color:#F8F8F2">(rawHTML);</span></span>
<span class="line"><span style="color:#88846F">      // greater than 5</span></span>
<span class="line"><span style="color:#A6E22E">      expect</span><span style="color:#F8F8F2">(steamSellers.length, </span><span style="color:#A6E22E">greaterThan</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">5</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#F8F8F2">  });</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span></code></pre>
<p>This is a test case for the <code>parseSteamTopSellers</code> function, which is defined in the <code>core.dart</code> file. The test case is written using the <code>test</code> function from the <code>test</code> package.</p>
<p>The test case starts by loading the sample HTML file, <code>sample.html</code>, into a string, <code>rawHTML</code>, using the <code>readAsStringSync</code> method of the <code>File</code> class. The <code>rawHTML</code> string is then passed to the <code>parseSteamTopSellers</code> function, which returns a list of <code>SteamTopSeller</code> objects.</p>
<p>The test case then uses the <code>expect</code> function to check that the length of the list of top sellers is greater than 5. This is just a simple example to verify that the <code>parseSteamTopSellers</code> function is correctly parsing the HTML and returning a list of <code>SteamTopSeller</code> objects. In a real scenario, you might want to write more tests to check the contents of the list, as well as edge cases where the HTML is not in the expected format.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://friendlyuser.github.io/posts/tech/flutter/alfred_backend_with_open_food_facts_api/">https://friendlyuser.github.io/posts/tech/flutter/alfred_backend_with_open_food_facts_api/</a></li>
<li><a href="https://huggingface.co/spaces/FriendlyUser/dart_off_server/tree/main">https://huggingface.co/spaces/FriendlyUser/dart_off_server/tree/main</a></li>
</ul> </astro-slot></content></div><div id="comments"></div></div></div></div><!--astro:end--></astro-island> <div class="mx-auto mt-5 max-w-prose flex justify-between gap-4 border-t border-gray-700 pt-8 text-sm text-gray-400 dark:text-gray-500"> <div class="w-full sm:w-[48%] xl:w-auto"> <div class="text-xs uppercase">Previous</div> <a class="text-blue-400 hover:underline" href="/posts/tech/2024/getting_started_with_remix"> Getting Started with Remix: A Deep Dive into the React Ecosystem </a> </div> <div class="text-right w-full sm:w-[48%] xl:w-auto"> <div class="text-xs uppercase">Next</div> <a class="text-blue-400 hover:underline" href="/posts/tech/2023/Swift_Performance_Optimization_Techniques"> Swift Performance Optimization Techniques </a> </div> </div><div class="mt-6 text-center"> <a href="/posts" class="text-blue-400 hover:underline text-sm">
&larr; Back to blog
</a> </div> <astro-island uid="1KiplR" prefix="r0" component-url="/_astro/ScrollButtons.BdAHGQrx.js" component-export="default" renderer-url="/_astro/client.D9Vng9vH.js" props="{}" ssr="" client="load" opts="{&quot;name&quot;:&quot;ScrollButtons&quot;,&quot;value&quot;:true}" await-children=""><div class="fixed bottom-8 right-8 z-50 flex flex-col gap-3 opacity-0 transition-opacity duration-300"><button aria-label="Scroll to comments" class="rounded-full bg-gray-200 p-2 text-gray-600 shadow-md hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll to top" class="rounded-full bg-gray-200 p-2 text-gray-600 shadow-md hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><!--astro:end--></astro-island>  </div> <div class="mx-auto max-w-screen-lg px-3 py-6"><div class="no-print border-t border-gray-600 pt-5"><div class="text-sm text-gray-200">© Copyright <!-- -->2025<!-- --> by <!-- -->Dhanushka&#x27;s Blog<!-- -->. Built with ♥ by<!-- --> <a class="text-cyan-400 hover:underline" href="https://github.com/dhanushka2001" target="_blank" rel="noopener noreferrer">Dhanushka</a>. Last updated on <!-- -->2025-07-11<!-- -->.</div></div></div> </body></html>